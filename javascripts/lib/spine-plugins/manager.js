(function(){var a,b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a},d=[].slice;a=Spine.$,Spine.Manager=function(a){function b(){this.controllers=[],this.bind("change",this.change),this.add.apply(this,arguments)}return c(b,a),b.name="Manager",b.include(Spine.Events),b.prototype.add=function(){var a,b,c,e,f;b=1<=arguments.length?d.call(arguments,0):[],f=[];for(c=0,e=b.length;c<e;c++)a=b[c],f.push(this.addOne(a));return f},b.prototype.addOne=function(a){var b=this;return a.bind("active",function(){var c;return c=1<=arguments.length?d.call(arguments,0):[],b.trigger.apply(b,["change",a].concat(d.call(c)))}),a.bind("release",function(){return b.controllers.splice(b.controllers.indexOf(a),1)}),this.controllers.push(a)},b.prototype.deactivate=function(){return this.trigger.apply(this,["change",!1].concat(d.call(arguments)))},b.prototype.change=function(){var a,b,c,e,f,g,h;c=arguments[0],a=2<=arguments.length?d.call(arguments,1):[],g=this.controllers,h=[];for(e=0,f=g.length;e<f;e++)b=g[e],b===c?h.push(b.activate.apply(b,a)):h.push(b.deactivate.apply(b,a));return h},b}(Spine.Module),Spine.Controller.include({active:function(){var a;return a=1<=arguments.length?d.call(arguments,0):[],typeof a[0]=="function"?this.bind("active",a[0]):(a.unshift("active"),this.trigger.apply(this,a)),this},isActive:function(){return this.el.hasClass("active")},activate:function(){return this.el.addClass("active"),this},deactivate:function(){return this.el.removeClass("active"),this}}),Spine.Stack=function(a){function b(){var a,c,e,f,g,h=this;b.__super__.constructor.apply(this,arguments),this.manager=new Spine.Manager,this.manager.bind("change",function(){var a,b;b=arguments[0],a=2<=arguments.length?d.call(arguments,1):[];if(b)return h.active.apply(h,a)}),f=this.controllers;for(a in f)c=f[a],this[a]=new c({stack:this}),this.add(this[a]);g=this.routes,e=function(a,b){var c;return typeof b=="function"&&(c=b),c||(c=function(){var a;return(a=h[b]).active.apply(a,arguments)}),h.route(a,c)};for(a in g)c=g[a],e(a,c);this["default"]&&this[this["default"]].active()}return c(b,a),b.name="Stack",b.prototype.controllers={},b.prototype.routes={},b.prototype.className="spine stack",b.prototype.add=function(a){return this.manager.add(a),this.append(a)},b}(Spine.Controller),typeof module!="undefined"&&module!==null&&(module.exports=Spine.Manager)}).call(this);